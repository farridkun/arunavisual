/*
	By André Rinas, www.andreknieriem.de
	Available for use under the MIT License
*/
!function(a,b,c,d){"use strict";a.fn.simpleLightbox=function(d){var s,d=a.extend({overlay:!0,spinner:!0,nav:!0,navText:["&lsaquo;","&rsaquo;"],captions:!0,captionDelay:0,captionSelector:"img",captionType:"attr",captionsData:"title",captionPosition:"bottom",close:!0,closeText:"×",swipeClose:!0,showCounter:!0,fileExt:"png|jpg|jpeg|gif",animationSlide:!0,animationSpeed:250,preloading:!0,enableKeyboard:!0,loop:!0,rel:!1,docClose:!0,swipeTolerance:50,className:"simple-lightbox",widthRatio:.8,heightRatio:.9,disableRightClick:!1,disableScroll:!0,alertError:!0,alertErrorMessage:"Image not found, next image will be loaded",additionalHtml:!1,history:!0},d),h=(b.navigator.pointerEnabled||b.navigator.msPointerEnabled,0),i=0,j=a(),k=function(){var a=c.body||c.documentElement,a=a.style;return""==a.WebkitTransition?"-webkit-":""==a.MozTransition?"-moz-":""==a.OTransition?"-o-":""==a.transition&&""},l=!1,m=[],n=function(b,c){var d=a(c.selector).filter(function(){return a(this).attr("rel")===b});return d},o=d.rel&&d.rel!==!1?n(d.rel,this):this,k=k(),p=k!==!1,q="pushState"in history,r=!1,t=b.location,u=function(){return t.hash.substring(1)},v=u(),w=function(){var b=(u(),"pid="+(G+1)),d=t.href.split("#")[0]+"#"+b;q?history[r?"replaceState":"pushState"]("",c.title,d):r?t.replace(d):t.hash=b,r=!0},x=function(){q?history.pushState("",c.title,t.pathname+t.search):t.hash="",clearTimeout(s)},y=function(){r?s=setTimeout(w,800):w()},z="simplelb",A=a("<div>").addClass("sl-overlay"),B=a("<button>").addClass("sl-close").html(d.closeText),C=a("<div>").addClass("sl-spinner").html("<div></div>"),D=a("<div>").addClass("sl-navigation").html('<button class="sl-prev">'+d.navText[0]+'</button><button class="sl-next">'+d.navText[1]+"</button>"),E=a("<div>").addClass("sl-counter").html('<span class="sl-current"></span>/<span class="sl-total"></span>'),F=!1,G=0,H=a("<div>").addClass("sl-caption pos-"+d.captionPosition),I=a("<div>").addClass("sl-image"),J=a("<div>").addClass("sl-wrapper").addClass(d.className),K=function(b){return!d.fileExt||"a"==a(b).prop("tagName").toLowerCase()&&new RegExp(".("+d.fileExt+")$","i").test(a(b).attr("href"))},L=function(){d.close&&B.appendTo(J),d.showCounter&&o.length>1&&(E.appendTo(J),E.find(".sl-total").text(o.length)),d.nav&&D.appendTo(J),d.spinner&&C.appendTo(J)},M=function(b){b.trigger(a.Event("show.simplelightbox")),d.disableScroll&&V("hide"),J.appendTo("body"),I.appendTo(J),d.overlay&&A.appendTo(a("body")),F=!0,G=o.index(b),j=a("<img/>").hide().attr("src",b.attr("href")),m.indexOf(b.attr("href"))==-1&&m.push(b.attr("href")),I.html("").attr("style",""),j.appendTo(I),Q(),A.fadeIn("fast"),a(".sl-close").fadeIn("fast"),C.show(),D.fadeIn("fast"),a(".sl-wrapper .sl-counter .sl-current").text(G+1),E.fadeIn("fast"),N(),d.preloading&&S(),setTimeout(function(){b.trigger(a.Event("shown.simplelightbox"))},d.animationSpeed)},N=function(c){if(j.length){var e=new Image,f=a(b).width()*d.widthRatio,g=a(b).height()*d.heightRatio;e.src=j.attr("src"),a(e).bind("error",function(b){o.eq(G).trigger(a.Event("error.simplelightbox")),F=!1,l=!0,C.hide(),d.alertError&&alert(d.alertErrorMessage),T(1==c||c==-1?c:1)}),e.onload=function(){"undefined"!=typeof c&&o.eq(G).trigger(a.Event("changed.simplelightbox")).trigger(a.Event((1===c?"nextDone":"prevDone")+".simplelightbox")),d.history&&y(),m.indexOf(j.attr("src"))==-1&&m.push(j.attr("src"));var h=e.width,i=e.height;if(h>f||i>g){var k=h/i>f/g?h/f:i/g;h/=k,i/=k}a(".sl-image").css({top:(a(b).height()-i)/2+"px",left:(a(b).width()-h)/2+"px"}),C.hide(),j.css({width:h+"px",height:i+"px"}).fadeIn("fast"),l=!0;var n="self"==d.captionSelector?o.eq(G):o.eq(G).find(d.captionSelector);if("data"==d.captionType)var q=n.data(d.captionsData);else if("text"==d.captionType)var q=n.html();else var q=n.prop(d.captionsData);if(d.loop||(0==G&&a(".sl-prev").hide(),G>=o.length-1&&a(".sl-next").hide(),G>0&&a(".sl-prev").show(),G<o.length-1&&a(".sl-next").show()),1==o.length&&a(".sl-prev, .sl-next").hide(),1==c||c==-1){var r={opacity:1};d.animationSlide&&(p?(P(0,100*c+"px"),setTimeout(function(){P(d.animationSpeed/1e3,"0px"),50})):r.left=parseInt(a(".sl-image").css("left"))+100*c+"px"),a(".sl-image").animate(r,d.animationSpeed,function(){F=!1,O(q)})}else F=!1,O(q);d.additionalHtml&&0==a(".sl-additional-html").length&&a("<div>").html(d.additionalHtml).addClass("sl-additional-html").appendTo(a(".sl-image"))}}},O=function(b){""!=b&&"undefined"!=typeof b&&d.captions&&H.html(b).hide().appendTo(a(".sl-image")).delay(d.captionDelay).fadeIn("fast")},P=function(b,c){var d={};d[k+"transform"]="translateX("+c+")",d[k+"transition"]=k+"transform "+b+"s linear",a(".sl-image").css(d)},Q=function(){a(b).on("resize."+z,N),a(c).on("click."+z+" touchstart."+z,".sl-close",function(a){a.preventDefault(),l&&U()}),d.history&&setTimeout(function(){a(b).on("hashchange."+z,function(){if(l&&u()===v)return void U()})},40),D.on("click."+z,"button",function(b){b.preventDefault(),h=0,T(a(this).hasClass("sl-next")?1:-1)});var e=0,f=0,g=0,j=0,k=!1,m=0;I.on("touchstart."+z+" mousedown."+z,function(a){return!!k||(p&&(m=parseInt(I.css("left"))),k=!0,e=a.originalEvent.pageX||a.originalEvent.touches[0].pageX,g=a.originalEvent.pageY||a.originalEvent.touches[0].pageY,!1)}).on("touchmove."+z+" mousemove."+z+" pointermove MSPointerMove",function(a){return!k||(a.preventDefault(),f=a.originalEvent.pageX||a.originalEvent.touches[0].pageX,j=a.originalEvent.pageY||a.originalEvent.touches[0].pageY,h=e-f,i=g-j,void(d.animationSlide&&(p?P(0,-h+"px"):I.css("left",m-h+"px"))))}).on("touchend."+z+" mouseup."+z+" touchcancel."+z+" mouseleave."+z+" pointerup pointercancel MSPointerUp MSPointerCancel",function(a){if(k){k=!1;var b=!0;d.loop||(0==G&&h<0&&(b=!1),G>=o.length-1&&h>0&&(b=!1)),Math.abs(h)>d.swipeTolerance&&b?T(h>0?1:-1):d.animationSlide&&(p?P(d.animationSpeed/1e3,"0px"):I.animate({left:m+"px"},d.animationSpeed/2)),d.swipeClose&&Math.abs(i)>50&&Math.abs(h)<d.swipeTolerance&&U()}})},R=function(){D.off("click","button"),a(c).off("click."+z,".sl-close"),a(b).off("resize."+z),a(b).off("hashchange."+z)},S=function(){var b=G+1<0?o.length-1:G+1>=o.length-1?0:G+1,c=G-1<0?o.length-1:G-1>=o.length-1?0:G-1;a("<img />").attr("src",o.eq(b).attr("href")).on("load",function(){m.indexOf(a(this).attr("src"))==-1&&m.push(a(this).attr("src")),o.eq(G).trigger(a.Event("nextImageLoaded.simplelightbox"))}),a("<img />").attr("src",o.eq(c).attr("href")).on("load",function(){m.indexOf(a(this).attr("src"))==-1&&m.push(a(this).attr("src")),o.eq(G).trigger(a.Event("prevImageLoaded.simplelightbox"))})},T=function(b){o.eq(G).trigger(a.Event("change.simplelightbox")).trigger(a.Event((1===b?"next":"prev")+".simplelightbox"));var c=G+b;if(!(F||(c<0||c>=o.length)&&0==d.loop)){G=c<0?o.length-1:c>o.length-1?0:c,a(".sl-wrapper .sl-counter .sl-current").text(G+1);var e={opacity:0};d.animationSlide&&(p?P(d.animationSpeed/1e3,-100*b-h+"px"):e.left=parseInt(a(".sl-image").css("left"))+-100*b+"px"),a(".sl-image").animate(e,d.animationSpeed,function(){setTimeout(function(){var c=o.eq(G);j.attr("src",c.attr("href")),m.indexOf(c.attr("href"))==-1&&C.show(),a(".sl-caption").remove(),N(b),d.preloading&&S()},100)})}},U=function(){if(!F){var b=o.eq(G),c=!1;b.trigger(a.Event("close.simplelightbox")),x(),a(".sl-image img, .sl-overlay, .sl-close, .sl-navigation, .sl-image .sl-caption, .sl-counter").fadeOut("fast",function(){d.disableScroll&&V("show"),a(".sl-wrapper, .sl-overlay").remove(),R(),c||b.trigger(a.Event("closed.simplelightbox")),c=!0}),j=a(),l=!1,F=!1}},V=function(d){if("hide"==d){var e=b.innerWidth;if(!e){var f=c.documentElement.getBoundingClientRect();e=f.right-Math.abs(f.left)}if(c.body.clientWidth<e){var g=c.createElement("div"),h=parseInt(a("body").css("padding-right"),10);g.className="sl-scrollbar-measure",a("body").append(g);var i=g.offsetWidth-g.clientWidth;a(c.body)[0].removeChild(g),a("body").data("padding",h),i>0&&a("body").addClass("hidden-scroll").css({"padding-right":h+i})}}else a("body").removeClass("hidden-scroll").css({"padding-right":a("body").data("padding")})};return L(),o.on("click."+z,function(b){if(K(this)){if(b.preventDefault(),F)return!1;M(a(this))}}),a(c).on("click."+z+" touchstart."+z,function(b){l&&d.docClose&&0==a(b.target).closest(".sl-image").length&&0==a(b.target).closest(".sl-navigation").length&&U()}),d.disableRightClick&&a(c).on("contextmenu",".sl-image img",function(a){return!1}),d.enableKeyboard&&a(c).on("keyup."+z,function(a){if(a.preventDefault(),h=0,l){var b=a.keyCode;27==b&&U(),37!=b&&39!=a.keyCode||T(39==a.keyCode?1:-1)}}),this.open=function(b){b=b||a(this[0]),M(b)},this.next=function(){T(1)},this.prev=function(){T(-1)},this.close=function(){U()},this.destroy=function(){a(c).unbind("click."+z).unbind("keyup."+z),U(),a(".sl-overlay, .sl-wrapper").remove(),this.off("click")},this.refresh=function(){this.destroy(),a(this.selector).simpleLightbox(d)},this}}(jQuery,window,document);
